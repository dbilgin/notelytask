# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase

on: workflow_dispatch
# on:
#   push:
#     tags:
#       - v*

jobs:
  build_and_preview:
    runs-on: ubuntu-latest
    steps:
        # Setup Java environment in order to build the Android app.
      - uses: actions/checkout@v2

      - run: echo "${{ secrets.ENV_FILE }}" | base64 --decode > assets/.env

      - name: Setup Flutter SDK
        uses: flutter-actions/setup-flutter@v3
        with:
          channel: stable
          version: 3.27.0

      - run: flutter doctor -v

      - run: flutter clean

      # Get flutter dependencies.
      - run: flutter pub get

      # Statically analyze the Dart code for any errors.
      - run: flutter analyze .

      - name: Build Release
        run: flutter build web

      - name: Install Firebase
        run: curl -sL https://firebase.tools | bash

      - name: Deploy to Firebase
        run: firebase deploy --only hosting --token ${{secrets.FIREBASE_TOKEN}}